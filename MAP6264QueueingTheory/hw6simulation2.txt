>list
10 rem MAP6264 HW5 Simulation based on Lindley
15 customers = 1000000
20 dim q(100)
95 input n
100 for i = 1 to customers
110 ia = -1*(1/1.2)*log(rnd(1))
120 t = t+ia
130 w = w+x-ia
140 if w < 0 then w = 0
150 if w > 0 then 205
160 sw = sw+w
170 x = -log(rnd(1))
180 sx = sx+x
190 next i
200 print sx/t,c/customers,sw/(customers-c)
202 end
205 j = 0
210 j = j+1
215 if j > n then c = c+1
218 if j > n then x = 0
220 if j > n then 190
230 if q(j) > t then 210
240 q(j) = t+w
250 goto 160
>run
? 0
0.545226        0.545608        0 
>run
? 1
0.724966        0.394978        0.544166 
>run
? 2
0.813522        0.320884        1.115831 
>run
? 4
0.899275        0.25194         2.358049 
>run
? 8
0.961553        0.200977        5.17695 
>run
? 16
run
0.992233        0.171387        11.753746 
>? 32
0.999714        0.165265        27.004833 
>run
? 64
1.000071        0.165294        58.996241 
>170 x = 1
>run
? 0
0.544983        0.545761        0 
>run
? 1
0.799582        0.334374        0.417993 
>run
? 2
0.894324        0.254954        1.010829 
>run
? 4
0.960873        0.198512        2.397628 
>run
? 8
0.992314        0.172627        5.712256 
>run
? 16
0.999584        0.167562        13.400053 
>run
? 32
1.000035        0.166137        29.343299 
>run
? 64
1.000069        0.166462        61.284238 
>
